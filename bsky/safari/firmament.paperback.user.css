/* ==UserStyle==
@name           Firmament
@namespace      https://bsky.app/profile/haraiva.bsky.app
@version        0.3.3
@description    a customisable theme for Bluesky Social by @haraiva.bsky.social based on @fenny.zone's "Better Bluesky" userstyle.
@updateURL      https://github.com/haraiva/userstyles/raw/main/bsky/safari/firmament.paperback.user.css
@license        MIT
@match          *://*.bsky.app/*
@var select tweak-option-use-title "Use Custom Title" {
  "yes:Yes": "none",
  "no:No": "0px"
}
@var text tweak-option-title "Custom Title (in quotes)" "'🌙'"
@var text tweak-option-font "Font Family (in quotes)" "'InterVariable'"
@var number tweak-option-line-height "Line Height" [1.3, null, null, 0.05]
@var select tweak-option-text-transform "Text Transform" {
  "none:None": "revert",
  "lowercase:lowercase": "lowercase",
  "uppercase:UPPERCASE": "uppercase"
}
@var select tweak-option-disable-outlines "Disable Focus Outlines (select No if you use keyboard navigation)" {
  "yes:Yes": "none",
  "no:No": "1px auto"
}

//🎨 COLOUR PALETTE: secondhand paperback
@var color tweak-option-accent "Accent" #b97f05
@var color tweak-option-bg "Light Mode Background" #e6ddd3
@var color tweak-option-text "Light Mode Text Color" #2d2823
@var color tweak-option-bg-dark "Dark Mode Background" #212124
@var color tweak-option-text-dark "Dark Mode Text Color" #d7cfc0

}"

==/UserStyle== */

/* 🚨📲🚨 if you're using Userscripts for iOS, delete the @-moz-document line
       above, and the closing "}" at the very bottom of the file.
       Then uncomment the block below and replace the values with your options.

       When the theme updates, just remove the @-moz-document lines again, and copy
       your customized options block into the new version. */
       
/* uncomment this block for Safari -- these are your tweaks  */
    :root {
        --tweak-option-use-title: none;
        --tweak-option-title: '🌙';
        
        --tweak-option-font: 'InterVariable';
        --tweak-option-line-height: 1.3;
        --tweak-option-text-transform: revert;
        --tweak-option-disable-outlines: none;

        --tweak-option-accent: #b97f05;
        --tweak-option-bg: #e6ddd3;
        --tweak-option-text: #2d2823;

        --tweak-option-accent-dark: #b97f05;
        --tweak-option-bg-dark: #212124;
        --tweak-option-text-dark: #d7cfc0;
    } 

/*
    Section headings (search for the emoji to jump to them quickly!)
    🔘 CONTROLS
    📱 UI
    🏠 FEED
    💬 POSTS
    🖱️ CONTEXT MENUS
    🪟 MODALS
    📝 POST COMPOSER
    🖼️ IMAGES
    🔍 SEARCH & MY FEEDS
    📋 LISTS
    🔔 NOTIFICATIONS
    👤 PROFILE
    🛠️ MODERATION/SETTINGS
*/

    :root {
        --tweak-accent: var(--tweak-option-accent, #5f8e76);
        --tweak-bg: var(--tweak-option-bg, #e6ded4);
        --tweak-fg: var(--tweak-option-text, #2f2b27);

        --tweak-bg-secondary: color-mix(in srgb, var(--tweak-bg) 90%, black);
        --tweak-bg-tertiary: color-mix(in srgb, var(--tweak-bg) 75%, black);
        --tweak-bg-translucent: color-mix(in srgb, var(--tweak-bg) 75%, transparent);
        --tweak-fg-translucent: color-mix(in srgb, var(--tweak-fg) 65%, transparent);
        --tweak-fg-more-translucent: color-mix(in srgb, var(--tweak-fg) 25%, transparent);
        --tweak-accent-translucent: color-mix(in srgb, var(--tweak-accent) 50%, transparent);
        --tweak-accent-more-translucent: color-mix(in srgb, var(--tweak-accent) 25%, transparent);

        --tweak-radius: 14px;
        --tweak-blur: blur(30px);
        --tweak-shadow: rgba(0, 0, 0, 0.3) 0px 5px 20px;

        --background: var(--tweak-bg) !important;
        --backgroundLight: var(--tweak-bg) !important;
        --text: var(--tweak-fg) !important;
    }

    /* override inline light mode colors */
    @media (not (prefers-color-scheme: dark)) {
        [style*="background-color: rgb(255, 255, 255)"],
        [style*="background-color: rgb(246, 247, 249)"] {
            background-color: var(--tweak-bg) !important;
        }
        [style*="background-color: rgb(226, 231, 236)"],
        [style*="background-color: rgb(240, 242, 245)"],
        [style*="background-color: rgb(241, 243, 245)"],
        [style*="background-color: rgb(243, 243, 248)"] {
            background-color: var(--tweak-bg-secondary) !important;
        }
        [style*="color: rgb(7, 10, 13)"],
        [style*="color: rgb(11, 15, 20)"],
        [style*="color: rgb(37, 51, 66)"], 
        [style*="color:rgb(11, 15, 20)"] {
            color: var(--tweak-fg) !important;
        }
        [style*="color: rgb(66, 87, 108)"],
        [style*="color: rgb(102, 127, 153)"],
        [style*="color: rgb(111, 134, 159)"] {
            color: var(--tweak-fg-translucent) !important;
        }
        [fill="#000000" i],
        [fill="#545664" i],
        [fill="#71768A" i] {
            fill: var(--tweak-fg-translucent) !important;
        }
    }

    /* override inline dark mode colors */
    @media (prefers-color-scheme: dark) {
        :root {
            --tweak-accent: var(--tweak-option-accent-dark, #5f8e76);
            --tweak-bg: var(--tweak-option-bg-dark, #000f10);
            --tweak-fg: var(--tweak-option-text-dark, #e9daca);

            --tweak-bg-secondary: color-mix(in srgb, var(--tweak-bg) 85%, white);
            --tweak-bg-tertiary: color-mix(in srgb, var(--tweak-bg) 75%, white);
        }
        [style*="background-color: rgb(0, 0, 0)"],
        [style*="background-color: rgb(8, 10, 12)"],
        [style*="background-color: rgb(22, 30, 39)"],
        [style*="background-color: rgb(28, 38, 49)"] {
            background-color: var(--tweak-bg) !important;
        }
        [style*="background-color: rgb(30, 41, 54)"],
        [style*="background-color: rgb(38, 53, 68)"],
        [style*="background-color: rgb(33, 45, 59)"], 
        [style*="background-color: rgb(21, 52, 85)"], 
        [style*="background-color: rgb(10, 95, 186)"]{
            background-color: var(--tweak-bg-secondary) !important;
        }
        
        [style*="background-color: rgb(46, 64, 82)"]{ 
            background-color: var(--tweak-accent) !important;
        }
        
        [style*="color: rgb(215, 221, 228)"],
        [style*="color: rgb(255, 255, 255)"], 
        [style*="color: rgb(241, 243, 245)"] {
            color: var(--tweak-fg) !important;
        }
        
        [style*="color: rgb(174, 187, 201)"],
        [style*="color: rgb(154, 170, 188)"],
        [style*="color: rgb(108, 132, 157)"],
        [style*="color: rgb(120, 142, 165)"], 
        [style*="color: rgb(91, 119, 149)"] {
            color: var(--tweak-fg-translucent) !important;
        }
        
        [style*="background-color: rgb(76, 162, 254)"] {
            background-color: var(--tweak-fg-translucent) !important;
        }
        
        [fill="#FFFFFF" i],
        [fill="#B9B9C1" i],
        [fill="#707489" i] {
            fill: var(--tweak-fg-translucent) !important;
        }
    }

    * {
        border-color: var(--tweak-bg-secondary) !important;
        -webkit-font-smoothing: auto;
    }
    *:focus {
        outline: var(--tweak-option-disable-outlines, none);
    }
    *:not(input, textarea) {
        text-transform: var(--tweak-option-text-transform, 'lowercase');
    }

    :not(.material-symbols-outlined, .material-icons) {
        font-family: var( --tweak-option-font, InterVariable, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Liberation Sans', Helvetica, Arial, sans-serif) !important;
        line-height: var(--tweak-option-line-height, 1.3) !important;
    }
    ::selection {
        background-color: color-mix(in srgb, var(--tweak-fg) 25%, transparent);
    }

    /* accent color override */
    [style*='color: rgb(16, 131, 254)'],
    [style*='color: rgb(32, 139, 254)'],
    [style*='color: rgb(76, 162, 254)'],
    .ProseMirror a,
    .ProseMirror .autolink {
        color: var(--tweak-accent) !important;
    }
    [style*='background-color: rgb(0, 133, 255)'],
    [style*='background-color: rgb(16, 131, 254)'],
    [style*='background-color: rgb(32, 139, 254)'],
    [style*='background-color: rgb(91, 119, 149)'],
    [style*='background-color: rgb(140, 158, 178)'],
    [style*='background-color: rgb(185, 185, 193)'] {
        background-color: var(--tweak-accent) !important;
    }

[style*='text-decoration-color: rgb(32, 139, 254)'] {
        text-decoration-color: var(--tweak-accent) !important;
}
    [fill^="hsl(211,"] {
        fill: var(--tweak-fg) !important;
    }
    [fill="#0085ff"] {
        fill: var(--tweak-accent) !important;
    }
    /* fix text color for style-colored buttons */
    button[style*='background-color: rgb(0, 133, 255)'] div {
        color: var(--tweak-bg) !important;
    }

    /* buttons with gradient backgrounds */
    [style*="background-image: linear-gradient"][style*="rgb(90, 113, 250)"] {
        background: var(--tweak-accent) !important;
    }
    [style*="background-image: linear-gradient"][style*="rgb(90, 113, 250)"]:hover {
        background: var(--tweak-fg) !important;
    }
    [style*="background-image: linear-gradient"][style*="rgb(90, 113, 250)"] > div {
        color: var(--tweak-bg) !important
    }

    @keyframes fade-in {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }
    @keyframes scale-up {
        from {
            transform: scale(0);
        }
        to {
            transform: scale(1);
        }
    }

       html, body, #root { background-color: var(--tweak-bg) !important; }

    /* 🔘 CONTROLS */

    /* text fields */
    input,
    textarea {
        background: var(--tweak-bg-secondary) !important;
    }
    input::placeholder,
    textarea::placeholder,
    p[data-placeholder]::before,
    [data-testid="composePostView"] [contenteditable="true"] {
        color: var(--tweak-fg-translucent) !important;
    }
    textarea {
        resize: vertical !important;
    }
    /* search glyphs */
    svg:has(+ input) {
        color: var(--tweak-fg) !important;
    }
    svg:has(+ input) path[fill] {
        fill: var(--tweak-fg) !important;
    }
    
    /* slider track */
    [style*="background-color: rgb(63, 63, 63)"] {
        background-color: var(--tweak-accent) !important;
    }
    [style*="background-color: rgb(179, 179, 179)"] {
        background-color: var(--tweak-accent-translucent) !important;
    }

    /* on/off switches */
    .r-1mhb1uw {
        justify-content: center;
        border-width: 1px !important;
        border-color: var(--tweak-accent) !important;
    }
    [style*='background-color: rgb(19, 63, 109)'],
    [aria-checked] > [style*='background-color: rgb(255, 255, 255)'],
    [aria-checked] > [style*='background-color: rgb(22, 30, 39)'] {
        background-color: var(--tweak-accent-translucent) !important;
    }

    /* post language radio buttons */
    button path[d^='M256 512A256'] {
        fill: var(--tweak-accent) !important;
    }

    /* settings radio buttons */
    .r-19tjxh9.r-1k25im9 {
        justify-content: center;
        border-width: 1px !important;
        border-color: var(--tweak-accent) !important;
    }

    /* segmented controls */
    [style*="background-color: rgb(46, 63, 81)"],
    [style*='background-color: rgb(201, 210, 219)'] {
        background-color: var(--tweak-accent) !important;
    }
    [style*="background-color: rgb(46, 63, 81)"] div,
    [style*='background-color: rgb(201, 210, 219)'] div {
        color: var(--tweak-bg) !important;
    }
   @media (prefers-color-scheme: light) {
        .r-18u37iz > button.r-ytbthy[style*='background-color: rgb(255, 255, 255)'] {
            background: var(--tweak-bg-secondary) !important;
        }
        .r-18u37iz > button.r-ytbthy[style*='background-color: rgb(0, 0, 0)'] {
            background: var(--tweak-accent) !important;
        }
       .r-18u37iz > button.r-ytbthy[style*='background-color: rgb(0, 0, 0)'] > * {
            color: var(--tweak-bg) !important;
        }
    }
    @media (prefers-color-scheme: dark) {
        .r-18u37iz > button.r-ytbthy[style*='background-color: rgb(0, 0, 0)'],
        .r-18u37iz > button.r-ytbthy[style*='background-color: rgb(22, 30, 39)'] {
            background: var(--tweak-bg-secondary) !important;
        }
        .r-18u37iz > button.r-ytbthy[style*='background-color: rgb(255, 255, 255)'] {
            background: var(--tweak-accent) !important;
        }
        .r-18u37iz > button.r-ytbthy[style*='background-color: rgb(255, 255, 255)'] > * {
            color: var(--tweak-bg) !important;
        }
    }

    /* 📱 UI */

    /* mobile feed top bar */ :not(.r-13awgt0):has(> div > div > [data-testid="viewHeaderDrawerBtn"]),
    /* tablet top bar */ div:has(> [data-testid="homeScreenFeedTabs"]),
    /* mobile bottom bar */ [style*="bottom: 0px; left: 0px; right: 0px;"],
    /* profile top bar */ [data-testid="profilePager"] {
        background: var(--tweak-bg-translucent) !important;
        -webkit-backdrop-filter: var(--tweak-blur) !important;
        backdrop-filter: var(--tweak-blur) !important;
    }
    @media (prefers-reduced-transparency: reduce) {
        /* mobile feed top bar */ :not(.r-13awgt0):has(> div > div > [data-testid="viewHeaderDrawerBtn"]),
        /* tablet top bar */ div:has(> [data-testid="homeScreenFeedTabs"]),
        /* mobile bottom bar */ [style*="bottom: 0px; left: 0px; right: 0px;"],
        /* profile top bar */ [data-testid="profilePager"] {
            background: var(--tweak-bg-secondary) !important;
            -webkit-backdrop-filter: none !important;
            backdrop-filter: none !important;
        }
    }

    /* don't fade mobile top or bottom bars */
    :has(> [data-testid="homeScreenFeedTabs"]),
    [style*="bottom: 0px; left: 0px; right: 0px;"] {
        opacity: 1 !important;
        pointer-events: auto !important;
    }

    /* remove inner backgrounds on mobile top bar */
    :has(> div > [data-testid="viewHeaderDrawerBtn"]),
    [data-testid="homeScreenFeedTabs"] {
        /*background: transparent !important;*/
    }

    /* remove backgrounds on mobile top bar items */
    :has(> [aria-label="Open navigation"]),
    :has(> [aria-label="Home Feed Preferences"]),
    :has(> [aria-label="Following Feed Preferences"]) {
        background: transparent !important;
    }
    
    /* fix tablet top bar item ordering */
    [aria-label="Following Feed Preferences"] {
        order: -2;
    }

    /* mobile bottom bar shadow */
    [style*="bottom: 0px; left: 0px; right: 0px;"] {
        box-shadow: var(--tweak-shadow);
    }

    /* consistent mobile bottom bar icon height */
    [style*="bottom: 0px; left: 0px; right: 0px;"] svg {
        height: 28px;
    }

    /* mobile bottom bar icon accent color */
    div[role='link'] svg:has(path[d^='m 23.951,2 c']),
    div[role='link'] svg:has(ellipse[fill='currentColor']),
    div[role='link'] svg:has(ellipse[fill='none']),
    div[role='link'] svg[stroke-width='4'],
    div[role='link'] svg:has(path[d^='M 11.642 2 H 12.442'][fill='currentColor']),
    div[role='link'] svg:has(:nth-child(3):last-child) {
        color: var(--tweak-accent, var(--tweak-fg)) !important;
    }

    /* vertically center mobile bottom bar icons */
    #root > div > div > div[style*='padding-bottom: 15px'] {
        padding-bottom: 10px !important;
    }

    /* fade hamburger menu & image viewer backdrops */
    .r-2lfw2k, :has(> button[aria-label='Close image viewer']) {
        animation: 125ms fade-in;
    }

    /* hamburger menu drawer */
    [data-testid='drawer'] {
        background-color: var(--tweak-bg);
        box-shadow: var(--tweak-shadow);
    }

    /* hamburger menu feedback button */
    [data-testid='drawer'] [aria-label='Send feedback']:first-child {
        background: var(--tweak-accent);
    }
    [data-testid='drawer'] [aria-label='Send feedback']:first-child * {
        color: var(--tweak-bg) !important;
        fill: var(--tweak-bg) !important;
    }

    /* hamburger menu help button */
    [data-testid='drawer'] [aria-label='Send feedback'] + [role='link'] > * {
        color: var(--tweak-fg) !important;
    }
    
    /* tooltips */
    [data-tooltip]::after {
        background-color: var(--tweak-bg);
        color: var(--tweak-fg);
        box-shadow: var(--tweak-shadow);
        border-radius: 6px;
    }
    @media (prefers-color-scheme: dark) {
        [data-tooltip]::after {
            border: 1px solid;
            border-color: inherit;
        }
    }
    
    /* toasts */
    .r-umfvqw.r-18rd0c5.r-ctyi22 {
        background-color: var(--tweak-bg-translucent);
        -webkit-backdrop-filter: var(--tweak-blur);
        backdrop-filter: var(--tweak-blur);
        box-shadow: var(--tweak-shadow);
    }
    @media (prefers-color-scheme: dark) {
        .r-umfvqw.r-18rd0c5.r-ctyi22 {
            border-width: 1px !important;
        }
    }
    .r-umfvqw.r-18rd0c5.r-ctyi22 path {
        fill: var(--tweak-fg);
    }
    .r-umfvqw.r-18rd0c5.r-ctyi22 div {
        color: var(--tweak-fg);
    }

    /* 🏠 FEED */

    /* custom title text */
    .css-175oi2r.r-1ljd8xs.r-13l2t4g.r-5laclt.r-33ulu8:nth-child(1) div.css-175oi2r { 
        width: 100% !important; 
        align-items: center; justify-content: center;
    }

    .css-175oi2r.r-1ljd8xs.r-13l2t4g.r-5laclt.r-33ulu8 .css-175oi2r svg:has(> path[d^="M13.873 3.805C21.21"])  {  
        display: var(--tweak-option-use-title); 
    }
    
    .css-175oi2r.r-1ljd8xs.r-13l2t4g.r-5laclt.r-33ulu8:nth-child(1) div.css-175oi2r::after { 
        order: -1;
        height: var(--tweak-option-use-title);
        content: var(--tweak-option-title);
        font-size: 32px;
        background-color: var(--tweak-accent);
        color: transparent;
        -webkit-background-clip: text;
        background-clip: text; 
    }

    /* feed, profile, list tabs container */
    [data-testid="homeScreenFeedTabs-selector"] > :first-child:last-child,
    [data-testid="profilePager-selector"] > :first-child:last-child,
    [data-testid="undefined-selector"] > :first-child:last-child {
        margin-inline: 0;
    }

    /* feed, profile, list tabs */
    [data-testid^="homeScreenFeedTabs-selector-"],
    [data-testid^="profilePager-selector-"],
    [data-testid^="undefined-selector-"] {
        /* padding-block: 7px;
        margin-block: 7px;
        margin-inline: 3.5px;
        background-clip: padding-box;
        border-radius: var(--tweak-radius); */
        transition: background 125ms; 
       
    }

    [data-testid^="homeScreenFeedTabs-selector-"] div,
    [data-testid^="profilePager-selector-"] div,
    [data-testid^="undefined-selector-"] div {
        /* padding-bottom: 0; */
         border-color: var(--tweak-accent) !important;
    }

    /* inactive tab names */
    [data-testid^="homeScreenFeedTabs-selector-"] .r-oucylx div,
    [data-testid^="profilePager-selector-"] .r-oucylx div,
    [data-testid^="undefined-selector-"] .r-oucylx div {
        font-weight: 500 !important;
    }

    [data-testid="homeScreenFeedTabs-selector"] .r-oucylx,
    [data-testid="profilePager-selector"] .r-oucylx,
    [data-testid="undefined-selector"] .r-oucylx {
        border-color: transparent !important;
    }

    /* scroll to top button */
    [aria-label='Load new posts'],
    [aria-label='Load new notifications'] {
        background: var(--tweak-bg-translucent) !important;
        -webkit-backdrop-filter: var(--tweak-blur);
        backdrop-filter: var(--tweak-blur);
        box-shadow: var(--tweak-shadow);
    }
    @media (max-width: 799px) {
        [aria-label='Load new posts'],
        [aria-label='Load new notifications'] {
            transform: translateY(-34px) !important;
        }
    }
    @media (prefers-color-scheme: dark) {
        [aria-label='Load new posts'],
        [aria-label='Load new notifications'] {
            border-width: 1px !important;
        }
    }

    /* compose button */
    [aria-label='New post'], [aria-label="New chat"] {
        cursor: pointer;
         transition: all 125ms;
    }
    [aria-label='New post']:hover, [aria-label="New chat"]:hover {
        background-color: var(--tweak-bg-secondary) !important;
        transition: all 125ms;
        border-radius: 64px;
        
    }
    @media (max-width: 799px) {
        [aria-label='New post'] {
            transform: translateY(-44px) !important;
        }
    }
    [aria-label='New post'] div,
    [aria-label='New post'] svg {
        color: var(--tweak-bg);
        /* stroke: var(--tweak-bg); */
    }

    /* desktop compose button and other buttons, new posts badge */
    .r-wzwllv {
        background-color: var(--tweak-accent) !important;
    }
    .r-wzwllv div {
        color: var(--tweak-bg);
    }

    /* mobile compose button */
    /*[aria-label='New post']:not(.r-wzwllv) {
        box-shadow: var(--tweak-shadow);
    }*/

    /* 💬 POSTS */

    /* disable hand cursor on posts in feed */
    [data-testid*='feedItem-'].r-1loqt21 {
        cursor: auto;
    }

    /* quote posts, URL cards, URL cards in post composer */
    :is([data-testid='contentHider-post'], [data-testid^="postThreadItem-"], [data-testid="composePostView"]) [aria-label^="Post by"] { border-width: 0px; }

/* OUTDATED? STUFF */
    /*:is([data-testid='contentHider-post'], [data-testid^="postThreadItem-"]) a > div:not(:has(> [data-testid="userAvatarImage"])),
    [data-testid="composePostView"] :has(> [aria-label="Remove image preview"]) {
        border-width: 1px !important;
        border-radius: 8px;
        border-color: var(--tweak-fg-more-translucent) !important;
        transition: background 125ms;
    }*/
    
    /* highlight quoted post on hover */
/*     :is([data-testid='contentHider-post'], [data-testid^="postThreadItem-"], [data-testid="composePostView"]) [aria-label^="Post by"]:hover {
        border-color: transparent !important;
        background: var(--tweak-fg-more-translucent) !important;
    } */
    
    /* remove inner background */
     :is([data-testid^="postThreadItem-"], [data-testid="composePostView"]) [aria-label^="Post by"] a {
        background-color: var(--tweak-bg) !important;
    } 

    /* highlight embedded link on hover */
    :is([data-testid='contentHider-post'], [data-testid^="postThreadItem-"]) a > div:not(:has(> [data-testid="userAvatarImage"])):hover {
        border-color: transparent !important;
        background: var(--tweak-fg-more-translucent) !important;
    }
    
    
    /* don't underline on hover */
    :is([data-testid='contentHider-post'], [data-testid^="postThreadItem-"], [data-testid="composePostView"]) [aria-label^="Post by"] a:hover,
    :is([data-testid='contentHider-post'], [data-testid^="postThreadItem-"]) a:hover {
        text-decoration: none;
    }
    
    /* content warning banners */
    [data-testid='contentHider-embed'] button.r-14gqq1x {
        margin-top: 0;
    }
    /* remove border radius when inside a quote post */
    [data-testid='contentHider-embed']:has(a) button.r-14gqq1x {
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
    }
    
    /* ... button */
    [aria-label="More post options"] path[fill] {
        fill: var(--tweak-fg-translucent) !important;
    }

    /* make reply connecting line thinner */
    .r-m5arl1 {
        width: 2px;
    }

    /* reply threading lines */
    .r-m5arl1 {
        width: 2px;
        translate: 0px;
        background-color: var(--tweak-bg-tertiary) !important;
    }
    [style*="border-left-width"]:has(~ div > div[data-testid^="postThreadItem"]) {
        border-left-width: 1px !important;
    }
    [data-testid="followingFeedPage"]  .r-1mhb1uw, [data-testid="postsFeed"] .r-1mhb1uw {
        border-color: transparent !important;
    }

    /* hand cursor for "view full thread" link */
    .r-e69tdv ~ .css-1rynq56 {
        cursor: pointer !important;
    }

    /* 🖱️ CONTEXT MENUS */
    
    /* block clicks on elements behind context menu */
    [data-radix-focus-guard] {
        height: 100vh;
        width: 100vw;
        /* pointer-events: auto !important; */
    }
    [data-radix-popper-content-wrapper] {
        z-index: 1 !important;
        background: var(--tweak-bg);
    }
    
    /* disable language picker background dim */
    [aria-label="Toggle dropdown"] {
        opacity: 0;
    }
    
    /* menu styles */
    [data-radix-popper-content-wrapper] > [role='menu'],
    [aria-label="Toggle dropdown"] ~ div:has(> button) {
        background: var(--tweak-bg-translucent) !important;
        -webkit-backdrop-filter: var(--tweak-blur);
        backdrop-filter: var(--tweak-blur);
        transform-origin: top center;
        animation: 125ms scale-up;
        border-radius: var(--tweak-radius);
    }
    @media (prefers-color-scheme: dark) {
        [data-radix-popper-content-wrapper] > [role='menu'],
        [aria-label="Toggle dropdown"] ~ div:has(> button) {
            border-width: 1px !important;
        }
    }
    @media (prefers-reduced-transparency: reduce) {
        [data-radix-popper-content-wrapper] > [role='menu'],
        [aria-label="Toggle dropdown"] ~ div:has(> button) {
            background: var(--tweak-bg) !important;
             -webkit-backdrop-filter: none;
            backdrop-filter: none;
        }
    }
    @media (prefers-reduced-motion: reduce) {
        [data-radix-popper-content-wrapper] > [role='menu'],
        [aria-label="Toggle dropdown"] ~ div:has(> button) {
            animation-name: fade-in;
        }
    }
    
    /* remove child background */
    [data-radix-popper-content-wrapper] > [role='menu'] > div {
        background-color: transparent !important;
    }
    
    /* font size and weight */
    [data-radix-popper-content-wrapper] [role="menuitem"] > div {
        font-weight: 400 !important;
        font-size: 16px !important;
    }
    
    /* language picker */
    [aria-label="Toggle dropdown"] ~ div:has(> button) {
        padding-inline: 4px;
        box-shadow: var(--tweak-shadow);
        transform-origin: bottom right;
    }
    
    /* hover highlight for language picker options */
    [aria-label="Toggle dropdown"] ~ div > button:hover {
        background-color: rgba(0, 0, 0, 0.067) !important;
        border-radius: 8px;
    }
    @media (prefers-color-scheme: dark) {
        [aria-label="Toggle dropdown"] ~ div > button:hover {
            background: rgba(255, 255, 255, 0.07) !important;
        }
    }
    
    /* dividers */
    [data-radix-popper-content-wrapper] [role='separator'] {
        background: var(--tweak-fg-more-translucent) !important;
    }
    [aria-label="Toggle dropdown"] ~ div > div {
        border-bottom-width: 1px !important;
        border-color: var(--tweak-fg-more-translucent) !important;
    }
    /* fix padding for "Post language" label */
    [aria-label="Toggle dropdown"] ~ div > div:first-child {
        padding-bottom: 16px;
    }

    /* 🪟 MODALS & BACKDROPS */

    /* remove darkening from modals & backdrops */
    /* hamburger menu backdrop */ .r-2lfw2k,
    /* image viewer backdrop */ :has(> button[aria-label='Close image viewer']),
    /* muted words modal backdrop */ [aria-label="Close active dialog"][style^="position: fixed"] > div[style*="background-color"],
    /* post composer/alt text backdrop */ [style*="background-color: rgba(0, 0, 0, 0.8)"] {
        background: transparent !important;
    }

    /* animate backgrounds - the pseudo-element is to work around a Safari issue */
    /* hamburger menu backdrop */ .r-2lfw2k::before,
    /* image viewer backdrop */ :has(> button[aria-label='Close image viewer'])::before,
    /* muted words modal backdrop */ [aria-label="Close active dialog"][style^="position: fixed"] > div[style*="background-color"]::before,
    /* post composer/alt text backdrop */ [style*="background-color: rgba(0, 0, 0, 0.8)"]::before {
        position: fixed;
        width: 100%;
        height: 100%;
        content: '';
        background: var(--tweak-bg-translucent) !important;
        -webkit-backdrop-filter: var(--tweak-blur) !important;
        backdrop-filter: var(--tweak-blur) !important;
        animation: 250ms fade-in;
    }
    @media (prefers-reduced-transparency: reduce) {
        /* hamburger menu backdrop */ .r-2lfw2k::before,
        /* image viewer backdrop */ :has(> button[aria-label='Close image viewer'])::before,
        /* muted words modal backdrop */ [aria-label="Close active dialog"][style^="position: fixed"] > div[style*="background-color"]::before,
        /* post composer/alt text backdrop */ [style*="background-color: rgba(0, 0, 0, 0.8)"]::before {
            background: var(--tweak-bg-secondary) !important;
            -webkit-backdrop-filter: none !important;
            backdrop-filter: none !important;
        }
    }

    /* remove muted words background padding */
    [aria-label="Close active dialog"] {
        padding: 0 !important;
    }

    /* modals */
    :has(> [data-testid="composePostView"]),
    .r-33ulu8.r-7h7f8p.r-rsyp9y {
        max-width: min(600px, calc(100vw - 40px)) !important;
        margin: 0 20px;
        border-radius: var(--tweak-radius) !important;
        box-shadow: var(--tweak-shadow);
    }
    @media (prefers-color-scheme: dark) {
        :has(> [data-testid="composePostView"]),
        .r-33ulu8.r-7h7f8p.r-rsyp9y {
            border-width: 1px !important;
        }
    }
    
    /* giving the text area in the post editor a little more breathing room */ 
    [data-testid="composePostView"] > div > div:nth-child(2) { padding-block: 8px; }

    /* 📝 POST COMPOSER */

    /* vertically center post composer */
    :has(> div > [data-testid='composePostView']) {
        justify-content: center;
    }
    
    /* consistent padding */
    [data-testid='composePostView'] > div {
        padding-top: 0 !important;
    }
    
    /* content warning button */
    [data-testid="labelsBtn"] svg[stroke] {
        stroke: var(--tweak-accent);
    }

    /* post composer and alt text text fields */
    .ProseMirror :not(i, .material-symbols-outlined, .material-icons),
    [aria-label='Image alt text'] {
        text-transform: none !important;
        color: var(--tweak-fg);
    }
    
    /* character count circle */
    [data-testid='composePostView'] svg[width="30"][height="30"] [stroke] {
        stroke: var(--tweak-accent) !important;
    }

    /* alt text modal */
    [data-testid='altTextImageModal'] {
        padding: 0 10px;
    }

    /* reply settings, add image, emoji buttons */
    [data-testid="openReplyGateButton"] path,
    [data-testid="openGalleryBtn"] path,
    [aria-label="Open emoji picker"] path,
    [data-testid="openGifBtn"] path {
        fill: var(--tweak-accent) !important;
    }

    /* reply settings selected option */
    :is([aria-label="Everybody"], [aria-label="Nobody"], [aria-label="Mentioned users"], [aria-label="Followed users"], [aria-label^="Users in"]):has(svg) {
        background-color: var(--tweak-accent) !important;
        border-radius: 8px;
    }
    :is([aria-label="Everybody"], [aria-label="Nobody"], [aria-label="Mentioned users"], [aria-label="Followed users"], [aria-label^="Users in"]):has(svg) div {
        color: var(--tweak-bg) !important;
        border-radius: 8px;
    }

    /* reply settings non-selected options */
    :is([aria-label="Everybody"], [aria-label="Nobody"], [aria-label="Mentioned users"], [aria-label="Followed users"], [aria-label^="Users in"]):hover {
        background: var(--tweak-accent-translucent) !important;
        border-radius: 8px;
    }
    :is([aria-label="Everybody"], [aria-label="Nobody"], [aria-label="Mentioned users"], [aria-label="Followed users"], [aria-label^="Users in"]) svg path[fill] {
        fill: var(--tweak-bg) !important;
        border-radius: 8px;
    }
    
    /* link card remove image preview button */
    [aria-label="Remove image preview"] {
        background: var(--tweak-accent);
    }
    [aria-label="Remove image preview"] path[fill] {
        fill: var(--tweak-bg) !important;
    }

    /* post/reply buttons */
    [data-testid="openReplyGateButton"] + div {
        background: var( --tweak-accent) !important;
    }
    [data-testid="openReplyGateButton"] + div > div {
        color: var(--tweak-bg) !important;
    }

    /* 🖼️ IMAGES */

    /* alt text indicator */
    [data-testid="contentHider-embed"] .r-xjggfu.r-18c5d7m.r-kdyh1x {
        background-color: var(--tweak-bg);
        box-shadow: var(--tweak-shadow);
    }
    [data-testid="contentHider-embed"] .r-xjggfu.r-18c5d7m.r-kdyh1x div {
        color: var(--tweak-fg);
    }

    /* image prev/next buttons */
    [aria-label='Previous image'],
    [aria-label='Next image'] {
        background: var(--tweak-bg-translucent);
        -webkit-backdrop-filter: var(--tweak-blur);
        backdrop-filter: var(--tweak-blur);
        opacity: 0.5;
        transition: opacity 125ms !important;
    }
    @media (hover: hover) {
        [aria-label='Previous image']:hover,
        [aria-label='Next image']:hover {
            opacity: 1
        }
    }

    /* move image close button to left */
    :has(> div > [aria-label="Close image"]) {
        right: auto !important;
        left: 10px;
    }

    /* image close button */
    [aria-label="Close image"] {
        background: var(--tweak-accent);
        box-shadow: var(--tweak-shadow);
    }

    /* image viewer button glyphs */
    [aria-label="Close image"] .r-jwli3a {
        color: var(--tweak-bg) !important;
    }
    [aria-label='Previous image'] path,
    [aria-label='Next image'] path {
        transform: scale(0.75);
        transform-origin: center;
        fill: var(--tweak-fg);
    }

    /* alt text */
    :has(> [aria-label='Expand alt text']) {
        background-color: var(--tweak-bg);
        box-shadow: var(--tweak-shadow);
    }
    [aria-label='Expand alt text'] > div {
        color: var(--tweak-fg);
        cursor: text;
        text-transform: none !important;
        user-select: text;
    }

    /* 🔍 SEARCH & MY FEEDS */
    
    /* saved feeds */
    [data-testid^="saved-feed-"] {
        border-radius: 8px;
    }
    
    /* follow buttons (also on follower/following list) */
    a[href^="/profile/"] button:has(div[style*='font-weight: 600']) {
        background-color: var(--tweak-accent) !important;
    }
    a[href^="/profile/"] button div[style*='font-weight: 600'] {
        color: var(--tweak-bg) !important;
    }

    /* 📋 LISTS */

    /* "Pin to home" button */
    [data-testid="pinBtn"] {
        background: var(--tweak-accent) !important;
    }
    [data-testid="pinBtn"] div {
        color: var(--tweak-bg) !important;
    }
    
    /* "Users" label */
    .css-146c3p1.r-cqee49 {
        color: var(--tweak-fg);
    }
    
    /* User search box */
    :has(> input[placeholder="Search for users"]) {
        margin-bottom: 10px;
        background: var(--tweak-bg-secondary);
        border-radius: 30px;
        padding: 8px 12px;
    }

    /* 🔔 NOTIFICATIONS */

    /* notifications number in Home sidebar */
    [aria-label="Notifications"] > div > div { color: var(--tweak-fg) !important;}

    div[aria-label*="unread items"] {
      background-color: var(--tweak-accent) !important;
      color: var(--tweak-fg) !important;
    }
    
    /* notification borders */
    [data-testid='notificationsScreen'] [data-testid^='feedItem-'] > div, [data-testid='notificationsScreen'] [data-testid^='feedItem-'] > div > div { 
    border-color: var(--tweak-bg-secondary) !important; 
    }

    /* round notification corners */
    [data-testid='notificationsScreen'] [style*='background-color:'] {
        border-radius: 0px;
    }

    /* highlight new notifications */
    [style*='background-color: rgb(240, 247, 255)'],
    [style*='background-color: rgb(21, 41, 63)'] {
        background: var(--tweak-accent-more-translucent) !important;
    }

    /* highlight replies in notifications */
    [data-testid='notificationsScreen'] [data-testid^='feedItem-'] > [role='link'] {
        margin-top: 8px !important;
        background: var(--tweak-bg-secondary) !important;
    }
    
    /* click/tap on Notifications to show only mentions */
    [data-testid="notificationsScreen"] button[aria-label="Menu"] + div {
        pointer-events: auto !important;
    }
    
    [data-testid="notificationsScreen"]:has(button[aria-label="Menu"] + div:is(:hover, :focus)) [data-testid="notifsFeed"] [role="link"]:has(> :nth-child(2)) {
        display: none !important;
    }

    /* 👤 PROFILE */

    /* allow text selection in profile header */
    [data-testid="profileView"] .r-12vffkv {
        pointer-events: auto !important;
    }

    /* fix profile pic border */
    [data-testid="profileHeaderAviButton"] {
        border: 2px solid var(--tweak-bg) !important;
    }

    /* hand cursor for profile pic */
    [data-testid='userAvatarImage'] {
        cursor: pointer;
    }

    /* suggestions button */
    [aria-label^="Show follows similar to"]:is([style*="background-color: rgb(0, 0, 0)"], [style*="background-color: rgb(255, 255, 255)"]) {
        background-color: var(--tweak-accent) !important;
    }
    [aria-label^="Show follows similar to"]:is([style*="background-color: rgb(0, 0, 0)"], [style*="background-color: rgb(255, 255, 255)"]) path {
        fill: var(--tweak-bg) !important;
    }

    /* Follow button */
    button[aria-label^="Follow "] {
        background-color: var(--tweak-accent) !important;
    }
    button[aria-label^="Follow "] path {
        fill: var(--tweak-bg) !important;
    }
    button[aria-label^="Follow "] div {
        color: var(--tweak-bg) !important;
    }

    /* 🛠️ MODERATION & SETTINGS */

    /* settings page backgrounds */
    [style*='background-color'].r-1dzdj1l.r-nsbfu8:has(button.r-gu64tb) {
        background-color: var(--tweak-bg) !important;
    }

    /* moderation/settings screen background  */
    [data-testid='moderationScreen'],
    .r-sa2ff0 {
        background: var(--tweak-bg) !important;
    }

    /* Delete My Account button text */
    /* button[aria-label="Delete account"] > div:nth-child(2) {
        color: var(--tweak-accent) !important; 
    } */

    /* fix alignment of threads settings switches */
    [style*='background-color'].r-1dzdj1l.r-nsbfu8 button.r-gu64tb {
        padding-left: 0;
    }

    /* language setting dividers */
    [style^="height: 1px; background-color:"] {
        visibility: hidden;
    }

    /* muted words text color */
    [aria-label="Manage your muted words and tags"] [style*="color: rgb(33, 45, 59)"],
    [aria-label="Manage your muted words and tags"] [style*="color: rgb(191, 201, 212)"] {
        color: var(--tweak-fg) !important;
    }

    /* muted words word text field */
    input[aria-label="Enter a word or tag"] + div {
        background: var(--tweak-bg-secondary) !important;
    }

    /* muted words options */
    div[aria-label^="Mute this word"][aria-checked="true"] > div {
        background: var(--tweak-accent) !important;
    }
    div[aria-label^="Mute this word"][aria-checked="true"] div {
        color: var(--tweak-bg) !important;
    }
    div[aria-label^="Mute this word"][aria-checked="true"] path {
        fill: var(--tweak-bg) !important;
    }

    div[aria-label^="Mute this word"][aria-checked="false"] > div {
        background: transparent !important;
    }
    div[aria-label^="Mute this word"][aria-checked="false"]:hover > div {
        background: var(--tweak-accent-translucent) !important;
    }
    div[aria-label^="Mute this word"][aria-checked="false"] div {
        color: var(--tweak-fg) !important;
    }

    /* muted words option radio buttons */
    div[aria-label^="Mute this word"][aria-checked="true"] div[style*="border-radius: 999px"] {
        background: var(--tweak-bg) !important;
    }
    div[aria-label^="Mute this word"] div[style*="border-radius: 999px"] > div[style*="border-radius: 999px"] {
        background: var(--tweak-accent) !important;
    }

    /* muted words Add button */
    button[aria-label="Add mute word for configured settings"] {
        background-color: var(--tweak-accent) !important;
    }
    button[aria-label="Add mute word for configured settings"] > div {
        opacity: 1 !important;
        color: var(--tweak-bg) !important;
    }
    button[aria-label="Add mute word for configured settings"] path {
        fill: var(--tweak-bg) !important;
    }
    
    /* muted words Remove button */
    [aria-label="Remove mute word from your list"] {
        background-color: var(--tweak-accent-translucent) !important;
    }
    [aria-label="Remove mute word from your list"]:hover {
        background-color: var(--tweak-accent) !important;
    }
    [aria-label="Remove mute word from your list"] path {
        fill: var(--tweak-bg) !important;
    }

    /* muted words list chips */
    [aria-label="Manage your muted words and tags"] [style*="background-color: rgb(46, 64, 82)"],
    [aria-label="Manage your muted words and tags"] [style*="background-color: rgb(212, 219, 226)"] {
        background-color: var(--tweak-fg-more-translucent) !important;
    }

    /* make the buttons look nice on hover */
    [data-testid="settingsScreen"] button.css-175oi2r.r-1i6wzkk.r-lrvibr.r-1loqt21.r-1otgn73:hover, div.css-175oi2r.r-105ug2t div.css-175oi2r.r-1loqt21.r-1otgn73 :hover, [data-testid^="switchToAccountBtn"] > div:hover { 
        background-color: var(--tweak-bg-tertiary) !important; 
    }